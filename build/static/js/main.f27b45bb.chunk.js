(this["webpackJsonpspotify-music-search-app"]=this["webpackJsonpspotify-music-search-app"]||[]).push([[0],{22:function(e,t,a){e.exports=a.p+"static/media/music.1b265192.jpeg"},56:function(e,t,a){e.exports=a(88)},87:function(e,t,a){},88:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(14),c=a.n(s),i=a(23),l=a(20),o=a(53),u=a(17),m=a(18),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=t.albums;switch(t.type){case"SET_ALBUMS":return a;case"ADD_ALBUMS":return Object(m.a)(Object(m.a)({},e),{},{next:a.next,items:[].concat(Object(u.a)(e.items),Object(u.a)(a.items))});default:return e}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=t.artists;switch(t.type){case"SET_ARTISTS":return a;case"ADD_ARTISTS":return Object(m.a)(Object(m.a)({},e),{},{next:a.next,items:[].concat(Object(u.a)(e.items),Object(u.a)(a.items))});default:return e}},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=t.playlists;switch(t.type){case"SET_PLAYLIST":return a;case"ADD_PLAYLIST":return Object(m.a)(Object(m.a)({},e),{},{next:a.next,items:[].concat(Object(u.a)(e.items),Object(u.a)(a.items))});default:return e}},b=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.d,f=Object(l.e)(Object(l.c)({albums:p,artists:d,playlist:E}),b(Object(l.a)(o.a))),h=a(30),y=a(31),v=a(33),g=a(32),O=a(19),S=a(5),_=a(91),T=a(90),j=function(){return r.a.createElement("h1",{className:"main-heading"},"Spotify Music Search")},x=Object(i.b)()((function(e){var t=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CLIENT_ID:"0fe158d082244c01b5364e5d785234c5",REACT_APP_AUTHORIZE_URL:"https://accounts.spotify.com/authorize",REACT_APP_REDIRECT_URL:"http://localhost:3000/redirect"}),a=t.REACT_APP_CLIENT_ID,n=t.REACT_APP_AUTHORIZE_URL,s=t.REACT_APP_REDIRECT_URL,c=e.isValidSession,i=e.location.state,l=i&&i.session_expired;return r.a.createElement(r.a.Fragment,null,c()?r.a.createElement(S.a,{to:"/dashboard"}):r.a.createElement("div",{className:"login"},r.a.createElement(j,null),l&&r.a.createElement(_.a,{variant:"info"},"Session expired. Please login again."),r.a.createElement(T.a,{variant:"info",type:"submit",onClick:function(){window.location="".concat(n,"?client_id=").concat(a,"&redirect_uri=").concat(s,"&response_type=token&show_dialog=true")}},"Login to spotify")))})),k=a(9),A=a.n(k),w=a(15),C=a(27),L=a.n(C),I=function(){try{var e=JSON.parse(localStorage.getItem("params"));e&&(L.a.defaults.headers.common.Authorization="Bearer ".concat(e.access_token))}catch(t){console.log("Error setting auth",t)}},D=function(e){Object(v.a)(a,e);var t=Object(g.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(y.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.setExpiryTime,a=e.history,n=e.location;try{if(A.a.isEmpty(n.hash))return a.push("/dashboard");var r=n.hash.slice(1).split("&").reduce((function(e,t){var a=t.split("="),n=Object(w.a)(a,2),r=n[0],s=n[1];return e[r]=s,e}),{}),s=(new Date).getTime()+1e3*r.expires_in;localStorage.setItem("params",JSON.stringify(r)),localStorage.setItem("expiry_time",s),t(s),a.push("/dashboard")}catch(c){a.push("/")}}},{key:"render",value:function(){return null}}]),a}(r.a.Component),N=a(7),P=a.n(N),R=a(16),U=function(){var e=Object(R.a)(P.a.mark((function e(t,a){var n;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(),e.next=3,L.a.get(t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),V=function(e){return{type:"SET_ALBUMS",albums:e}},B=function(e){return{type:"SET_ARTISTS",artists:e}},M=function(e){return{type:"SET_PLAYLIST",playlists:e}},F=function(e){return function(){var t=Object(R.a)(P.a.mark((function t(a){var n;return P.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,U(e);case 3:return n=t.sent,t.abrupt("return",a({type:"ADD_ALBUMS",albums:n.albums}));case 7:t.prev=7,t.t0=t.catch(0),console.log("error",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},H=function(e){return function(){var t=Object(R.a)(P.a.mark((function t(a){var n;return P.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,U(e);case 3:return n=t.sent,t.abrupt("return",a({type:"ADD_ARTISTS",artists:n.artists}));case 7:t.prev=7,t.t0=t.catch(0),console.log("error",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},J=function(e){return function(){var t=Object(R.a)(P.a.mark((function t(a){var n;return P.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,U(e);case 3:return n=t.sent,t.abrupt("return",a({type:"ADD_PLAYLIST",playlists:n.playlists}));case 7:t.prev=7,t.t0=t.catch(0),console.log("error",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},Y=a(93),K=a(22),W=a.n(K),q=function(e){var t=e.albums;return r.a.createElement(r.a.Fragment,null,Object.keys(t).length>0&&r.a.createElement("div",{className:"albums"},t.items.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(Y.a,{style:{width:"18rem"}},r.a.createElement("a",{target:"_blank",href:e.external_urls.spotify,rel:"noopener noreferrer",className:"card-image-link"},A.a.isEmpty(e.images)?r.a.createElement("img",{src:W.a,alt:""}):r.a.createElement(Y.a.Img,{variant:"top",src:e.images[0].url,alt:""})),r.a.createElement(Y.a.Body,null,r.a.createElement(Y.a.Title,null,e.name),r.a.createElement(Y.a.Text,null,r.a.createElement("small",null,e.artists.map((function(e){return e.name})).join(", "))))))}))))},z=function(e){var t=e.artists;return r.a.createElement(r.a.Fragment,null,Object.keys(t).length>0&&r.a.createElement("div",{className:"artists"},t.items.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(Y.a,{style:{width:"18rem"}},r.a.createElement("a",{target:"_blank",href:e.external_urls.spotify,rel:"noopener noreferrer",className:"card-image-link"},A.a.isEmpty(e.images)?r.a.createElement("img",{src:W.a,alt:""}):r.a.createElement(Y.a.Img,{variant:"top",src:e.images[0].url,alt:""})),r.a.createElement(Y.a.Body,null,r.a.createElement(Y.a.Title,null,e.name))))}))))},G=function(e){var t=e.playlist;return r.a.createElement("div",null,Object.keys(t).length>0&&r.a.createElement("div",{className:"playlist"},t.items.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement(Y.a,{style:{width:"18rem"}},r.a.createElement("a",{target:"_blank",href:e.external_urls.spotify,rel:"noopener noreferrer",className:"card-image-link"},A.a.isEmpty(e.images)?r.a.createElement("img",{src:W.a,alt:""}):r.a.createElement(Y.a.Img,{variant:"top",src:e.images[0].url,alt:""})),r.a.createElement(Y.a.Body,null,r.a.createElement(Y.a.Title,null,e.name),r.a.createElement(Y.a.Text,null,r.a.createElement("small",null,"By ",e.owner.display_name)))))}))))},X=function(e){var t=e.isValidSession,a=e.loadMore,n=e.result,s=e.setCategory,c=e.selectedCategory,i=n.albums,l=n.artists,o=n.playlist;return t()?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"search-buttons"},!A.a.isEmpty(i.items)&&r.a.createElement("button",{className:"".concat("albums"===c?"btn active":"btn"),onClick:function(){return s("albums")}},"Albums"),!A.a.isEmpty(l.items)&&r.a.createElement("button",{className:"".concat("artists"===c?"btn active":"btn"),onClick:function(){return s("artists")}},"Artists"),!A.a.isEmpty(o.items)&&r.a.createElement("button",{className:"".concat("playlist"===c?"btn active":"btn"),onClick:function(){return s("playlist")}},"PlayLists")),r.a.createElement("div",{className:"".concat("albums"===c?"":"hide")},i&&r.a.createElement(q,{albums:i})),r.a.createElement("div",{className:"".concat("artists"===c?"":"hide")},l&&r.a.createElement(z,{artists:l})),r.a.createElement("div",{className:"".concat("playlist"===c?"":"hide")},o&&r.a.createElement(G,{playlist:o})),!A.a.isEmpty(n[c])&&!A.a.isEmpty(n[c].next)&&r.a.createElement("div",{className:"load-more",onClick:function(){return a(c)}},r.a.createElement(T.a,{variant:"info",type:"button"},"Load More"))):r.a.createElement(S.a,{to:{pathname:"/",state:{session_expired:!0}}})},Z=a(92),Q=function(e){var t=Object(n.useState)(""),a=Object(w.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)(""),l=Object(w.a)(i,2),o=l[0],u=l[1];return r.a.createElement("div",null,r.a.createElement(Z.a,{onSubmit:function(t){t.preventDefault(),""!==s.trim()?(u(""),e.handleSearch(s)):u("Please enter a search term.")}},o&&r.a.createElement("p",{className:"errorMsg"},o),r.a.createElement(Z.a.Group,{controlId:"formBasicEmail"},r.a.createElement(Z.a.Label,null,"Enter search term"),r.a.createElement(Z.a.Control,{type:"search",name:"searchTerm",value:s,placeholder:"Search for album, artist or playlist",onChange:function(e){var t=e.target.value;c(t)},autoComplete:"off"})),r.a.createElement(T.a,{variant:"info",type:"submit"},"Search")))},$=function(e){var t=Object(n.useState)(document.createElement("div")),a=Object(w.a)(t,1)[0],r=document.querySelector("#loader");return Object(n.useEffect)((function(){r.appendChild(a).classList.add("message")}),[r,a]),Object(n.useEffect)((function(){e.show?(r.classList.remove("hide"),document.body.classList.add("loader-open")):(r.classList.add("hide"),document.body.classList.remove("loader-open"))}),[r,e.show]),c.a.createPortal(e.children,a)},ee=Object(i.b)((function(e){return{albums:e.albums,artists:e.artists,playlist:e.playlist}}))((function(e){var t=Object(n.useState)(!1),a=Object(w.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)("albums"),l=Object(w.a)(i,2),o=l[0],u=l[1],m=e.isValidSession,p=e.history,d=function(){var t=Object(R.a)(P.a.mark((function t(a){var n,r,s,i;return P.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!m()){t.next=18;break}n=e.dispatch,r=e.albums,s=e.artists,i=e.playlist,c(!0),t.t0=a,t.next="albums"===t.t0?6:"artists"===t.t0?9:"playlist"===t.t0?12:15;break;case 6:return t.next=8,n(F(r.next));case 8:return t.abrupt("break",15);case 9:return t.next=11,n(H(s.next));case 11:return t.abrupt("break",15);case 12:return t.next=14,n(J(i.next));case 14:return t.abrupt("break",15);case 15:c(!1),t.next=19;break;case 18:p.push({pathname:"/",state:{session_expired:!0}});case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),E={albums:e.albums,artists:e.artists,playlist:e.playlist};return r.a.createElement(r.a.Fragment,null,m()?r.a.createElement("div",null,r.a.createElement(j,null),r.a.createElement(Q,{handleSearch:function(t){m()?(c(!0),e.dispatch(function(e){return function(){var t=Object(R.a)(P.a.mark((function t(a){var n,r,s,c,i;return P.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n="https://api.spotify.com/v1/search?query=".concat(encodeURIComponent(e),"&type=album,playlist,artist"),t.next=4,U(n);case 4:return r=t.sent,console.log(r),s=r.albums,c=r.artists,i=r.playlists,a(V(s)),a(B(c)),t.abrupt("return",a(M(i)));case 12:t.prev=12,t.t0=t.catch(0),console.log("error",t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()}(t)).then((function(){c(!1),u("albums")}))):p.push({pathname:"/",state:{session_expired:!0}})}}),r.a.createElement($,{show:s},"Loading..."),r.a.createElement(X,{result:E,loadMore:d,setCategory:function(e){u(e)},selectedCategory:o,isValidSession:m})):r.a.createElement(S.a,{to:{pathname:"/",state:{session_expired:!0}}}))})),te=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(j,null),"Page not found. Goto ",r.a.createElement(O.b,{to:"/dashboard"},"Home Page"))},ae=function(e){Object(v.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(h.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={expiryTime:"0"},e.setExpiryTime=function(t){e.setState({expiryTime:t})},e.isValidSession=function(){return(new Date).getTime()<e.state.expiryTime},e}return Object(y.a)(a,[{key:"componentDidMount",value:function(){var e;try{e=JSON.parse(localStorage.getItem("expiry_time"))}catch(t){e="0"}this.setState({expiryTime:e})}},{key:"render",value:function(){var e=this;return r.a.createElement(O.a,null,r.a.createElement("div",{className:"main"},r.a.createElement(S.d,null,r.a.createElement(S.b,{path:"/",exact:!0,render:function(t){return r.a.createElement(x,Object.assign({isValidSession:e.isValidSession},t))}}),r.a.createElement(S.b,{path:"/redirect",render:function(t){return r.a.createElement(D,Object.assign({isValidSession:e.isValidSession,setExpiryTime:e.setExpiryTime},t))}}),r.a.createElement(S.b,{path:"/dashboard",render:function(t){return r.a.createElement(ee,Object.assign({isValidSession:e.isValidSession},t))}}),r.a.createElement(S.b,{component:te}))))}}]),a}(r.a.Component);a(86),a(87);c.a.render(r.a.createElement(i.a,{store:f},r.a.createElement(ae,null)),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.f27b45bb.chunk.js.map